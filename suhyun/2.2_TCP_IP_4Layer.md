# 2.2 TCP/IP 4계층 모델

`TCP/IP` 4계층 모델은 네트워크에서 사용되는 `통신 프로토콜의 집합`으로 네트워킹 범위에 따라 4개의 추상화로 나누어 진다.

## 2.2.1 계층 구조

각 계층들은 특정 계층이 변경되었을 때, 다른 계층이 영향을 받지 않도록 유연하게 설계되었다. 

<p align="center"><img src="https://thebook.io/img/080326/081.jpg" width="350" height="250"/></p>

- **애플리케이션 계층** : FTP, HTTP, SSH 등 응용 프로그램이 사용되는 계층으로 실질적으로 사람들에게 제공하는 층이다.

- **전송 계층** : 송수신자를 연결하는 통신 서비스를 제공하며 TCP/UDP를 사용하여 애플리케이션과 인터넷 계층 사이의 데이터가 전달될 떄 중계 역할을 한다.
    - TCP : 패킷 사이의 순서를 보장하고 연결지향 프로토콜을 사용하는 `가상회선 패킷 교환 방식`
    
    - UDP : 순서를 보장 및 수신 여부를 확인하지 않고 단순히 데이터만 교환하는 `데이터그램 패킷 교환 방식` 

> ● **TCP 연결 성립 과정 (3-way handshake)**
> <p align="center"><img src="https://thebook.io/img/080326/085.jpg" width="300" height="250"/></p>


> ● **TCP 연결 해제 과정 (4-way handshake)**
> <p align="center"><img src="https://thebook.io/img/080326/086.jpg" width="300" height="250"/></p>

- **인터넷 계층** : 네트워크 패킷을 IP 주소로 지정된 목적지로 전송하기 위해 사용되는 계층으로 IP, ARP, ICMP 등이 있으며 `비연결형적인 특징`을 가지고 있다.

- **데이터 링크 계층** : 전선, 무선 등 실질적으로 데이터를 전달하며 장치 간에 신호를 주고받는 `규칙`을 정하는 계층이다.

<br>

#### 통신 방법

---

- **전이중화 통신** : 양쪽 장치가 `동시에 송수신`할 수 있는 방식

<p align="center"><img src="https://thebook.io/img/080326/088.jpg" width="350" height="250"/></p>

- **반이중화 통신** : 양쪽 장치가 서로 통신할 수 있지, `동시에는 통신할 수 없는 방식`(한 번에 한 방향)

<p align="center"><img src="https://thebook.io/img/080326/090_2.jpg" width="350" height="250"/></p>

> CSMA/CD : 데이터를 ‘보낸 이후’ 충돌이 발생한다면 일정 시간 이후 재전송하는 방식
>
> CSMA/CA : 데이터를 보내기 전에 캐리어 감지 등으로 사전에 가능한 한 충돌을 방지하는 방식

<br>
#### 계층 간 데이터 송수신

---

애플리케이션 계층의 요청 값들이 캡슐화 과정읕 통해 목적지로 전달되고, 목적지의 애플리케이션 계층까지 비캡슐화 과정을 거쳐 데이터가 도착한다.

<p align="center"><img src="https://thebook.io/img/080326/094_1.jpg" width="350" height="250"/></p>

- 캡슐화 과정

상위 계층의 헤더를 하위 계층의 데이터 부분에 포함시키고 다시 `하위 계층의 데이터로 삽입`하는 과정을 말한다.

<p align="center"><img src="https://thebook.io/img/080326/094_2.jpg" width="350" height="200"/></p>

- 비캡슐화 과정

하위 계층에서 상위 계층으로 가며 각 계층의 `헤더 부분을 제거`하는 과정
<p align="center"><img src="https://thebook.io/img/080326/095.jpg" width="350" height="200"/></p>

## 2.2.2 PDU

계층에서 계층으로 데이터가 전달될 때 한 덩어리의 단위를 `PDU (Protocol Data Unit)`라고 한다.

PDU는 제어 관련 정보들이 포함된 ‘헤더’, 데이터를 의미하는 ‘페이로드’로 구성되어 있으며 계층마다 부르는 명칭이 다르다.

- 애플리케이션 계층: 메시지

- 전송 계층: 세그먼트(TCP), 데이터그램(UDP)

- 인터넷 계층: 패킷

- 링크 계층: 프레임(데이터 링크 계층), 비트(물리 계층)

 